本方案基于 AntV X6，在现有拓扑图之上构建一个纯前端的“仿真引擎”，用于展示节点间数据流动、节点状态变化、运行路径高亮等效果，整体不依赖后端。

一、整体架构

图模型层：使用 X6 的 Graph 保存拓扑结构，节点和边的 data 中增加仿真相关元数据，例如：节点角色（输入/处理/输出）、状态枚举（idle/active/processing/done/error）、出边优先级等。

仿真引擎层：在前端维护一个 SimulationEngine 对象，负责：

读取 Graph 结构，计算或接收一条或多条“执行路径”（节点序列 + 边序列）；

驱动节点状态机变化；

调度每一段边上的动画执行。

动画表现层：基于 X6 的视图能力，对节点、边和“令牌（token）”进行动画展示，实现数据包移动、边高亮、节点状态样式变化等效果。

二、数据结构与状态设计

在节点 node.getData() 中约定字段：

simRole: 'source' | 'processor' | 'sink'

simState: 'idle' | 'active' | 'processing' | 'done' | 'error'

在边的 data 中约定：

simOrder: 用于决定从某节点出发时多条出边的执行顺序；

simPathId: 所属路径标识，可支持多条并行路径。

仿真引擎内部维护一个队列或有序数组表示执行步骤，例如：

steps: Array<{ fromNodeId, toNodeId, edgeId }>，按顺序驱动。

三、仿真执行流程

初始化阶段：

扫描 Graph，重置所有节点/边为 idle 状态和默认样式；

计算或装载执行路径，填充 steps。

启动仿真 engine.start()：

将起始节点标记为 active，更新节点样式为高亮（改变颜色/描边）；

进入主调度循环，从 steps 取出第一步执行。

执行单步数据流：

根据 edgeId 找到边视图，创建一个小圆/小箭头 token，沿边做一次“从源到目标”的移动动画；

动画开始前，将该边标记为“当前路径高亮”，加粗或变色；

动画进行中可选地在边上叠加“流光/虚线流动”效果，增强数据流向感知。

动画完成回调：

将目标节点状态从 idle 切换为 processing，通过渐变颜色或闪烁边框表现；

将上一节点状态切换为 done，样式变为“已完成”颜色；

若该节点还有后续出边步骤，则短暂展示“processing”后推进到下一条边；若为终点节点则最终置为 done。

流程控制：

仿真引擎提供 start/pause/resume/reset 方法；

暂停时停止所有正在执行的 token 动画和节点/边过渡；

reset 时清空内部步骤指针、移除 token 元素，将节点/边状态还原。

四、表现层要求

节点状态变化统一通过“状态 -> 样式”映射表驱动，AI IDE 只需实现一个 applyNodeState(node, state) 函数集中处理样式切换。

边高亮同理，提供 highlightEdge(edge, mode)，支持：普通高亮、已执行路径高亮、当前执行高亮三种模式。

token 元素建议使用 SVG circle 或自定义 markup，支持颜色、大小配置，以便后续根据业务类型区分不同数据流。